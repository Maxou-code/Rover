<!-- html-minifier-terser interface.html --collapse-whitespace --remove-comments --remove-optional-tags --remove-redundant-attributes --remove-script-type-attributes --remove-style-link-type-attributes --minify-css true --minify-js true -o interface.min.html -->
<!DOCTYPE html>
<html lang="fr">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
	<title>Rover</title>
	<style>
	* {
		font-family: Arial;
		margin: 0;
		padding: 0;
	}

	body {
		display: flex;
		justify-content: space-evenly;
		align-items: center;
		height: 100vh;
		background: #2f2f2f;
		flex-direction: column;
	}

	h1 {
		color: white;
	}

	section {
		display: flex;
		width: 100%;
		justify-content: space-evenly;
	}

	div {
		background: rgba(0, 0, 0, 0.3);
		border-radius: 8px;
		display: flex;
		flex-direction: column;
		justify-content: center;
		gap: 15px;
		padding: 15px;
	}

	button {
		width: 140px;
		height: 40px;
		border-radius: 8px;
		border: none;
		font-weight: bold;
		cursor: pointer;
		transition: transform 0.1s ease-in-out;
	}

	button:active {
		transform: scale(0.9);
	}

	.container {
		color: white;
		width: 300px;
	}

	.container .mode {
		background-color: orange;
		width: 40px;
		height: 40px;
	}

	.video {
		transform: rotate(180deg);
		width: 550px;
		border-radius: 8px;
	}

	.image {
		text-align: center;
	}

	.image .orange {
		background-color: orange;
	}

	.controls {
		text-align: center;
		width: 300px;
	}

	.controls .blue {
		background-color: #0099FF;
		width: 90px;
		height: 80px;
	}

	.controls .red {
		background-color: #FB4040;
		width: 90px;
		height: 80px;
	}

	.controls .yellow {
		background-color: yellow;
	}

	/* Désactivation sélection texte */
	.no-select {
		user-select: none;
		-webkit-user-select: none;
		-ms-user-select: none;
	}
	</style>
	<script>
	function getsend(arg) {
		var xhttp = new XMLHttpRequest();
		xhttp.open('GET', arg + '?' + new Date().getTime(), true);
		xhttp.send();
	}

	function updateData() {
		var xhttp = new XMLHttpRequest();
		xhttp.onreadystatechange = function() {
			if (this.readyState == 4 && this.status == 200) {
				let data = JSON.parse(this.responseText);
				lat.textContent = data.Lat;
				lon.textContent = data.Lon;
				temp.textContent = data.Temp;
				hum.textContent = data.Hum;
				lum.textContent = data.LumMoy;
				d1.textContent = data.d1;
				d2.textContent = data.d2;
				d3.textContent = data.d3;
				d4.textContent = data.d4;
				mode.textContent = data.mode;
			}
		};
		xhttp.open("GET", "/data", true);
		xhttp.send();
	}

	setInterval(updateData, 100);

	document.addEventListener("keydown", function(event) {
		switch (event.key) {
			// Déplacements 
			case "ArrowUp":
				getsend("go");
				break;
			case "ArrowDown":
				getsend("back");
				break;
			case "ArrowLeft":
				getsend("left");
				break;
			case "ArrowRight":
				getsend("right");
				break;

				// Espace = STOP immédiat
			case " ":
				getsend("stop");
				break;

				// Lumières            
			case "l":
			case "L":
				getsend("ledon");
				break;
			case "m":
			case "M":
				getsend("ledoff");
				break;

				// Caméra 
			case "f":
			case "F":
				getsend("cam_left");
				break;
			case "g":
			case "G":
				getsend("cam_center");
				break;
			case "h":
			case "H":
				getsend("cam_right");
				break;

				// Changement mode
			case "à":
			case "0":
				getsend("mod_0");
				break;
			case "&":
			case "1":
				getsend("mod_1");
				break;
		}
	});

	document.addEventListener("keyup", function(event) {
		switch (event.key) {
			case "ArrowUp":
			case "ArrowDown":
			case "ArrowLeft":
			case "ArrowRight":
				getsend("stop");
				break;
		}
	});
	</script>
</head>

<body>
	<h1>Rover</h1>
	<section>
		<div class="container no-select">
			<h3>Latitude : <span id="lat">NC</span></h3>
			<h3>Longitude : <span id="lon">NC</span></h3>
			<h3>Température : <span id="temp">0</span>°C</h3>
			<h3>Humidité : <span id="hum">0</span>%</h3>
			<h3>Luminosité : <span id="lum">0</span></h3>
			<h3>Distance avant : <span id="d1">0</span></h3>
			<h3>Distance arrière : <span id="d2">0</span></h3>
			<h3>Distance droite : <span id="d3">0</span></h3>
			<h3>Distance gauche : <span id="d4">0</span></h3>
			<br>
			<h3>Mode : <span id="mode">0</span></h3>
			<p>
				<button class="mode" onmousedown="getsend('mod_0')">0</button>
				<button class="mode" onmousedown="getsend('mod_1')">1</button>
			</p>
		</div>
		<div class="image no-select">
			<img src="http://192.168.4.1:81/stream" class="video">
			<p>
				<button class="orange" onmousedown="getsend('cam_left')">Gauche</button>
				<button class="orange" onmousedown="getsend('cam_center')">Centre</button>
				<button class="orange" onmousedown="getsend('cam_right')">Droite</button>
			</p>
		</div>
		<div class="controls no-select">
			<p><button class="blue" onmousedown="getsend('go')" onmouseup="getsend('stop')">Avancer</button></p>
			<p>
				<button class="blue" onmousedown="getsend('left')" onmouseup="getsend('stop')">Gauche</button>
				<button class="red" onmousedown="getsend('stop')">Stop</button>
				<button class="blue" onmousedown="getsend('right')" onmouseup="getsend('stop')">Droite</button>
			</p>
			<p><button class="blue" onmousedown="getsend('back')" onmouseup="getsend('stop')">Reculer</button></p>
			<p>
				<button class="yellow" onmousedown="getsend('ledon')">Lumière ON</button>
				<button class="yellow" onmousedown="getsend('ledoff')">Lumière OFF</button>
			</p>
		</div>
	</section>
</body>

</html>