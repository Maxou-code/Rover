<!-- html-minifier-terser interface.html --collapse-whitespace --remove-comments --remove-optional-tags --remove-redundant-attributes --remove-script-type-attributes --remove-style-link-type-attributes --minify-css true --minify-js true -o interface.min.html -->
<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
<title>Rover</title>
<style>
* {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    min-height: 100vh;
    background: #2f2f2f;
    color: #fff;
    padding: 20px;
    gap: 20px;
}

h1 {
    margin-bottom: 20px;
}

section {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
    justify-content: center;
    width: 100%;
}

.card {
    background: rgba(0,0,0,0.3);
    border-radius: 10px;
    padding: 15px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px;
    min-width: 280px;
}

.card fieldset {
    border: 1px solid #555;
    border-radius: 8px;
    margin-bottom: 15px;
    padding: 10px 15px;
    width: 100%;
}

.card legend {
    padding: 0 10px;
    font-weight: bold;
}

.video {
    width: 100%;
    max-width: 550px;
    border-radius: 8px;
    transform: rotate(180deg);
}

.button-row {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
    justify-content: center;
}

button {
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-weight: bold;
    transition: transform 0.1s ease-in-out;
}

button:active {
    transform: scale(0.9);
}

/* Couleurs et tailles */
.mode { background-color: orange; width: 40px; height: 40px; }
.blue { background-color: #0099FF; width: 75px; height: 70px; }
.red { background-color: #FB4040; width: 75px; height: 70px; }
.orange { background-color: orange; width: 40px; height: 40px; }
.yellow { background-color: yellow; width: 100px; height: 40px; }

.button-cam { background-color: orange; width: 100px; height: 40px; }

/* Contrôle de vitesse */
.speed-control {
    display: flex;
    align-items: center;
    gap: 10px;
    justify-content: center;
}

/* Désactivation sélection texte */
.no-select {
    user-select: none;
    -webkit-user-select: none;
    -ms-user-select: none;
}
</style>
<script>
function getsend(arg) {
    fetch(arg + '?' + new Date().getTime());
}

function updateData() {
    fetch("/data").then(r => r.json()).then(data => {
        lat.textContent = data.Lat;
        lon.textContent = data.Lon;
        temp.textContent = data.Temp;
        hum.textContent = data.Hum;
        lum.textContent = data.LumMoy;
        dist_front.textContent = data.DistFront;
        dist_back.textContent = data.DistBack;
        dist_right.textContent = data.DistRight;
        dist_left.textContent = data.DistLeft;
        mod_move.textContent = data.ModMove;
        speed.textContent = data.Speed;
    });
}

setInterval(updateData, 100);

document.addEventListener("keydown", e => {
    switch(e.key) {
        case "ArrowUp": getsend("go"); break;
        case "ArrowDown": getsend("back"); break;
        case "ArrowLeft": getsend("left"); break;
        case "ArrowRight": getsend("right"); break;
        case " ": getsend("stop"); break;
        case "l": case "L": getsend("ledon"); break;
        case "m": case "M": getsend("ledoff"); break;
        case "f": case "F": getsend("cam_left"); break;
        case "g": case "G": getsend("cam_center"); break;
        case "h": case "H": getsend("cam_right"); break;
        case "à": case "0": getsend("mod_0"); break;
        case "&": case "1": getsend("mod_1"); break;
        case "s": getsend("up_speed"); break;
        case "q": getsend("down_speed"); break;
    }
});

document.addEventListener("keyup", e => {
    if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(e.key)) getsend("stop");
});
</script>
</head>
<body>
<h1>Rover</h1>
<section>
    <!-- Informations -->
    <div class="card no-select">
        <fieldset><legend>Capteurs</legend>
            <h3>Latitude : <span id="lat">NC</span></h3>
            <h3>Longitude : <span id="lon">NC</span></h3>
            <h3>Température : <span id="temp">0</span>°C</h3>
            <h3>Humidité : <span id="hum">0</span>%</h3>
            <h3>Luminosité : <span id="lum">0</span></h3>
            <h3>Distance avant : <span id="dist_front">0</span></h3>
            <h3>Distance arrière : <span id="dist_back">0</span></h3>
            <h3>Distance droite : <span id="dist_right">0</span></h3>
            <h3>Distance gauche : <span id="dist_left">0</span></h3>
        </fieldset>
        <fieldset><legend>Mode de déplacement</legend>
            <h3>Mode : <span id="mod_move">0</span></h3>
            <div class="button-row">
                <button class="mode" onmousedown="getsend('mod_0')">0</button>
                <button class="mode" onmousedown="getsend('mod_1')">1</button>
            </div>
        </fieldset>
    </div>

    <!-- Caméra -->
    <div class="card image no-select">
        <img src="http://192.168.4.1:81/stream" class="video">
        <div class="button-row">
            <button class="button-cam" onmousedown="getsend('cam_left')">Gauche</button>
            <button class="button-cam" onmousedown="getsend('cam_center')">Centre</button>
            <button class="button-cam" onmousedown="getsend('cam_right')">Droite</button>
        </div>
    </div>

    <!-- Contrôles -->
    <div class="card controls no-select">
        <div class="button-row">
            <button class="blue" onmousedown="getsend('go')" onmouseup="getsend('stop')">Avancer</button>
        </div>
        <div class="button-row">
            <button class="blue" onmousedown="getsend('left')" onmouseup="getsend('stop')">Gauche</button>
            <button class="red" onmousedown="getsend('stop')">Stop</button>
            <button class="blue" onmousedown="getsend('right')" onmouseup="getsend('stop')">Droite</button>
        </div>
        <div class="button-row">
            <button class="blue" onmousedown="getsend('back')" onmouseup="getsend('stop')">Reculer</button>
        </div>
        <div class="speed-control">
            <h3>Vitesse : <span id="speed">0</span></h3>
            <div class="button-row">
                <button class="orange" onmousedown="getsend('down_speed')">-</button>
                <button class="orange" onmousedown="getsend('up_speed')">+</button>
            </div>
        </div>
        <div class="button-row">
            <button class="yellow" onmousedown="getsend('ledon')">Lumière ON</button>
            <button class="yellow" onmousedown="getsend('ledoff')">Lumière OFF</button>
        </div>
    </div>
</section>
</body>
</html>
